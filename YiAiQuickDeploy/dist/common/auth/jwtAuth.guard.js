'use strict';const _0x54ce20=_0x2b0e;function _0x2b0e(_0x219390,_0x59ae21){const _0x2196d=_0x2196();return _0x2b0e=function(_0x2b0ea9,_0x4f4bad){_0x2b0ea9=_0x2b0ea9-0x187;let _0x29f9c6=_0x2196d[_0x2b0ea9];return _0x29f9c6;},_0x2b0e(_0x219390,_0x59ae21);}(function(_0x778a40,_0x4fe1e8){const _0x45e437=_0x2b0e,_0x3fb0f8=_0x778a40();while(!![]){try{const _0x4420bc=-parseInt(_0x45e437(0x194))/0x1+-parseInt(_0x45e437(0x192))/0x2*(-parseInt(_0x45e437(0x1af))/0x3)+parseInt(_0x45e437(0x187))/0x4+-parseInt(_0x45e437(0x1ad))/0x5+parseInt(_0x45e437(0x1aa))/0x6+parseInt(_0x45e437(0x1bd))/0x7*(parseInt(_0x45e437(0x1a4))/0x8)+-parseInt(_0x45e437(0x1c3))/0x9*(-parseInt(_0x45e437(0x1a0))/0xa);if(_0x4420bc===_0x4fe1e8)break;else _0x3fb0f8['push'](_0x3fb0f8['shift']());}catch(_0x33fc85){_0x3fb0f8['push'](_0x3fb0f8['shift']());}}}(_0x2196,0x71a28));var __decorate=this&&this['__decorate']||function(_0x2823d5,_0x56a94d,_0x49dcb3,_0x354587){const _0x5f34d9=_0x2b0e;var _0x5ab8d4=arguments[_0x5f34d9(0x1c5)],_0x3fdf52=_0x5ab8d4<0x3?_0x56a94d:_0x354587===null?_0x354587=Object[_0x5f34d9(0x18d)](_0x56a94d,_0x49dcb3):_0x354587,_0xf32b65;if(typeof Reflect===_0x5f34d9(0x1b9)&&typeof Reflect[_0x5f34d9(0x19e)]===_0x5f34d9(0x1c2))_0x3fdf52=Reflect[_0x5f34d9(0x19e)](_0x2823d5,_0x56a94d,_0x49dcb3,_0x354587);else{for(var _0x5ea43f=_0x2823d5[_0x5f34d9(0x1c5)]-0x1;_0x5ea43f>=0x0;_0x5ea43f--)if(_0xf32b65=_0x2823d5[_0x5ea43f])_0x3fdf52=(_0x5ab8d4<0x3?_0xf32b65(_0x3fdf52):_0x5ab8d4>0x3?_0xf32b65(_0x56a94d,_0x49dcb3,_0x3fdf52):_0xf32b65(_0x56a94d,_0x49dcb3))||_0x3fdf52;}return _0x5ab8d4>0x3&&_0x3fdf52&&Object['defineProperty'](_0x56a94d,_0x49dcb3,_0x3fdf52),_0x3fdf52;},__metadata=this&&this[_0x54ce20(0x196)]||function(_0x124bb0,_0x2a834f){const _0x25e74d=_0x54ce20;if(typeof Reflect==='object'&&typeof Reflect[_0x25e74d(0x1ab)]===_0x25e74d(0x1c2))return Reflect[_0x25e74d(0x1ab)](_0x124bb0,_0x2a834f);};function _0x2196(){const _0x2fe644=['874402AuVDuf','jsonwebtoken','__metadata','err:\x20','UNAUTHORIZED','jwt','HttpStatus','../../modules/auth/auth.service','globalConfigService','JWT_SECRET','decorate','createTokenFromFingerprint','1805860Lsghfh','../../modules/redisCache/redisCache.service','@nestjs/core','AuthGuard','8IdYHjy','getNineAiToken','user','env','authorization','extractToken','896142Gjpayn','metadata','validateToken','1029980ZwHmFc','slice','3alpUYn','headers','switchToHttp','handleRequest','__esModule','@nestjs/common','UnauthorizedException','Injectable','design:paramtypes','@nestjs/passport','object','fingerprint','split','canActivate','917581uyhGUc','GlobalConfigService','toString','redisCacheService','ModuleRef','function','9DtFMBd','x-website-domain','length','2410468kqhYNI','authService','AuthService','log','verify','RedisCacheService','getOwnPropertyDescriptor','get','HttpException','JwtAuthGuard','getRequest','964406XVrKrc','defineProperty'];_0x2196=function(){return _0x2fe644;};return _0x2196();}Object[_0x54ce20(0x193)](exports,_0x54ce20(0x1b3),{'value':!![]}),exports[_0x54ce20(0x190)]=void 0x0;const redisCache_service_1=require(_0x54ce20(0x1a1)),common_1=require(_0x54ce20(0x1b4)),passport_1=require(_0x54ce20(0x1b8)),jwt=require(_0x54ce20(0x195)),core_1=require(_0x54ce20(0x1a2)),globalConfig_service_1=require('../../modules/globalConfig/globalConfig.service'),auth_service_1=require(_0x54ce20(0x19b));let JwtAuthGuard=class JwtAuthGuard extends(0x0,passport_1[_0x54ce20(0x1a3)])(_0x54ce20(0x199)){constructor(_0x282508,_0x21b4ea,_0x4e41c8,_0x39fd24){const _0x396045=_0x54ce20;super(),this['redisCacheService']=_0x282508,this['moduleRef']=_0x21b4ea,this[_0x396045(0x19c)]=_0x4e41c8,this[_0x396045(0x188)]=_0x39fd24;}async[_0x54ce20(0x1bc)](_0x596850){const _0x314b01=_0x54ce20;!this[_0x314b01(0x1c0)]&&(this[_0x314b01(0x1c0)]=this['moduleRef'][_0x314b01(0x18e)](redisCache_service_1[_0x314b01(0x18c)],{'strict':![]}));const _0x3cb4e3=_0x596850[_0x314b01(0x1b1)]()[_0x314b01(0x191)](),_0x27e5b2=_0x3cb4e3[_0x314b01(0x1b0)][_0x314b01(0x1c4)],_0x1817ec=this[_0x314b01(0x1a9)](_0x3cb4e3);_0x3cb4e3[_0x314b01(0x1a6)]=this[_0x314b01(0x1ac)](_0x1817ec);const _0x2f1b8c=this[_0x314b01(0x19c)][_0x314b01(0x1a5)]();return await this[_0x314b01(0x1c0)]['checkTokenAuth'](_0x1817ec,_0x3cb4e3),!![];}['extractToken'](_0x36898b){const _0x19425e=_0x54ce20;if(!_0x36898b[_0x19425e(0x1b0)]['authorization']){if(_0x36898b[_0x19425e(0x1b0)]['fingerprint']){let _0x5a0607=_0x36898b[_0x19425e(0x1b0)][_0x19425e(0x1ba)];_0x5a0607>0x7fffffff&&(_0x5a0607=_0x5a0607[_0x19425e(0x1bf)]()[_0x19425e(0x1ae)](-0x9),_0x5a0607=Number(String(Number(_0x5a0607))));const _0xe03759=this['authService'][_0x19425e(0x19f)](_0x5a0607);return _0xe03759;}return null;}const _0x4a834b=_0x36898b['headers'][_0x19425e(0x1a8)][_0x19425e(0x1bb)]('\x20');if(_0x4a834b[_0x19425e(0x1c5)]!==0x2||_0x4a834b[0x0]!=='Bearer')return null;return _0x4a834b[0x1];}['validateToken'](_0x4bb180){const _0x58d005=_0x54ce20;try{return jwt[_0x58d005(0x18b)](_0x4bb180,process[_0x58d005(0x1a7)][_0x58d005(0x19d)]);}catch(_0x1e0f73){throw new common_1[(_0x58d005(0x18f))]('亲爱的用户,请登录后继续操作,我们正在等您的到来！',common_1[_0x58d005(0x19a)][_0x58d005(0x198)]);}}[_0x54ce20(0x1b2)](_0x346712,_0x247fd7,_0x4924cf){const _0xab3431=_0x54ce20;if(_0x346712||!_0x247fd7){console[_0xab3431(0x18a)](_0xab3431(0x197),_0x346712);throw _0x346712||new common_1[(_0xab3431(0x1b5))]();}return _0x247fd7;}};JwtAuthGuard=__decorate([(0x0,common_1[_0x54ce20(0x1b6)])(),__metadata(_0x54ce20(0x1b7),[redisCache_service_1['RedisCacheService'],core_1[_0x54ce20(0x1c1)],globalConfig_service_1[_0x54ce20(0x1be)],auth_service_1[_0x54ce20(0x189)]])],JwtAuthGuard),exports[_0x54ce20(0x190)]=JwtAuthGuard;