'use strict';const _0x1cf80a=_0x2f6e;(function(_0x3840a7,_0x452c63){const _0x137c93=_0x2f6e,_0x2534bc=_0x3840a7();while(!![]){try{const _0x337167=parseInt(_0x137c93(0x1be))/0x1*(-parseInt(_0x137c93(0x1d3))/0x2)+parseInt(_0x137c93(0x1c6))/0x3+parseInt(_0x137c93(0x1b5))/0x4*(parseInt(_0x137c93(0x1c5))/0x5)+-parseInt(_0x137c93(0x1d5))/0x6+-parseInt(_0x137c93(0x1bf))/0x7*(-parseInt(_0x137c93(0x1cd))/0x8)+-parseInt(_0x137c93(0x1d2))/0x9*(parseInt(_0x137c93(0x1ca))/0xa)+-parseInt(_0x137c93(0x1d1))/0xb;if(_0x337167===_0x452c63)break;else _0x2534bc['push'](_0x2534bc['shift']());}catch(_0x35cd66){_0x2534bc['push'](_0x2534bc['shift']());}}}(_0x1151,0x21886));function _0x1151(){const _0x273ce9=['645933siLzMv','defineProperty','expire','token:','370YQPMqc','visitor','您已在其他设备覆盖登录、请您重新登录！','23432JFRVQt','__metadata','length','__esModule','1668007EJGFlZ','369nWfcrM','30164fkgPgw','design:paramtypes','182982zmeimR','onModuleInit','ttl','zRange','RedisCacheService','HttpException','getOwnPropertyDescriptor','admin','includes','get','Injectable','test','__param','checkTokenAuth','del','19420hnVTim','function','super','set','forEach','user','invalidateTokens','metadata','decorate','1XMaWaM','161vhQnpU','Inject','UNAUTHORIZED','redisClient','@nestjs/common','HttpStatus','55UKxcen'];_0x1151=function(){return _0x273ce9;};return _0x1151();}var __decorate=this&&this['__decorate']||function(_0x35ada5,_0x1f315f,_0x4c2c3c,_0x10606d){const _0x873d40=_0x2f6e;var _0x336d00=arguments[_0x873d40(0x1cf)],_0x3aec06=_0x336d00<0x3?_0x1f315f:_0x10606d===null?_0x10606d=Object[_0x873d40(0x1ac)](_0x1f315f,_0x4c2c3c):_0x10606d,_0x20144e;if(typeof Reflect==='object'&&typeof Reflect[_0x873d40(0x1bd)]===_0x873d40(0x1b6))_0x3aec06=Reflect[_0x873d40(0x1bd)](_0x35ada5,_0x1f315f,_0x4c2c3c,_0x10606d);else{for(var _0x3a22f3=_0x35ada5[_0x873d40(0x1cf)]-0x1;_0x3a22f3>=0x0;_0x3a22f3--)if(_0x20144e=_0x35ada5[_0x3a22f3])_0x3aec06=(_0x336d00<0x3?_0x20144e(_0x3aec06):_0x336d00>0x3?_0x20144e(_0x1f315f,_0x4c2c3c,_0x3aec06):_0x20144e(_0x1f315f,_0x4c2c3c))||_0x3aec06;}return _0x336d00>0x3&&_0x3aec06&&Object[_0x873d40(0x1c7)](_0x1f315f,_0x4c2c3c,_0x3aec06),_0x3aec06;},__metadata=this&&this[_0x1cf80a(0x1ce)]||function(_0x27d835,_0x5d4ffc){const _0x35d57e=_0x1cf80a;if(typeof Reflect==='object'&&typeof Reflect[_0x35d57e(0x1bc)]==='function')return Reflect['metadata'](_0x27d835,_0x5d4ffc);},__param=this&&this[_0x1cf80a(0x1b2)]||function(_0x2c958b,_0x246f96){return function(_0x4526b9,_0x585391){_0x246f96(_0x4526b9,_0x585391,_0x2c958b);};};Object['defineProperty'](exports,_0x1cf80a(0x1d0),{'value':!![]}),exports[_0x1cf80a(0x1d9)]=void 0x0;const common_1=require(_0x1cf80a(0x1c3));let RedisCacheService=class RedisCacheService{constructor(_0x352e7e){this['redisClient']=_0x352e7e;}async[_0x1cf80a(0x1d6)](){}[_0x1cf80a(0x1b1)](){const _0x836434=_0x1cf80a;return this[_0x836434(0x1c2)][_0x836434(0x1b8)]('aaa',0x6f),0x1;}async[_0x1cf80a(0x1af)](_0x1928be){const _0x531ec2=_0x1cf80a,{key:_0x23aea5}=_0x1928be,_0xde7d7=await this['redisClient'][_0x531ec2(0x1af)](_0x23aea5);return await this[_0x531ec2(0x1c2)][_0x531ec2(0x1af)](_0x23aea5);}async['set'](_0x3484eb,_0x3909e8){const _0x5710a1=_0x1cf80a;try{const {key:_0x5063e1,val:_0x1f257d}=_0x3484eb;await this['redisClient'][_0x5710a1(0x1b8)](_0x5063e1,_0x1f257d),_0x3909e8&&await this[_0x5710a1(0x1c2)][_0x5710a1(0x1c8)](_0x5063e1,_0x3909e8);return;}catch(_0x1121ad){throw new common_1[(_0x5710a1(0x1ab))](_0x1121ad,common_1[_0x5710a1(0x1c4)]['BAD_REQUEST']);}}async[_0x1cf80a(0x1d7)](_0xf8dbcf){const _0x141115=_0x1cf80a;return await this[_0x141115(0x1c2)][_0x141115(0x1d7)](_0xf8dbcf);}async[_0x1cf80a(0x1b4)](_0x243137){const _0x1c73c3=_0x1cf80a,{key:_0x2c4e9d}=_0x243137;await this[_0x1c73c3(0x1c2)]['del'](_0x2c4e9d);return;}async['saveToken'](_0x2b61cf,_0x2fbc01){const _0x43d6b8=_0x1cf80a,_0x4c084a=await this['redisClient'][_0x43d6b8(0x1d8)]('tokens:'+_0x2b61cf,0x0,-0x1);await this[_0x43d6b8(0x1bb)](_0x2b61cf,_0x4c084a),this['redisClient'][_0x43d6b8(0x1b8)]('token:'+_0x2b61cf,_0x2fbc01);}async[_0x1cf80a(0x1bb)](_0x1baa5f,_0x2433a5){const _0x15518b=_0x1cf80a;_0x2433a5[_0x15518b(0x1b9)](_0x48c87c=>{const _0x36fbdc=_0x15518b;this['redisClient'][_0x36fbdc(0x1b4)]('token:'+_0x1baa5f+':'+_0x48c87c);});}async[_0x1cf80a(0x1b3)](_0x58b78c,_0x12beea){const _0x48ff0c=_0x1cf80a,{id:_0x746443,role:_0x347a0b}=_0x12beea[_0x48ff0c(0x1ba)];if(_0x347a0b===_0x48ff0c(0x1cb))return!![];const _0x221c7b=await this[_0x48ff0c(0x1c2)]['get'](_0x48ff0c(0x1c9)+_0x746443);if(_0x221c7b===null)return await this[_0x48ff0c(0x1c2)][_0x48ff0c(0x1b8)](_0x48ff0c(0x1c9)+_0x746443,_0x58b78c),!![];if(_0x221c7b!==_0x58b78c){if([_0x48ff0c(0x1b7),_0x48ff0c(0x1ad)][_0x48ff0c(0x1ae)](_0x347a0b))return!![];throw new common_1[(_0x48ff0c(0x1ab))](_0x48ff0c(0x1cc),common_1[_0x48ff0c(0x1c4)][_0x48ff0c(0x1c1)]);}}};function _0x2f6e(_0x40e6c7,_0x4eb55e){const _0x115142=_0x1151();return _0x2f6e=function(_0x2f6e32,_0x4fc98d){_0x2f6e32=_0x2f6e32-0x1ab;let _0x329cb0=_0x115142[_0x2f6e32];return _0x329cb0;},_0x2f6e(_0x40e6c7,_0x4eb55e);}RedisCacheService=__decorate([(0x0,common_1[_0x1cf80a(0x1b0)])(),__param(0x0,(0x0,common_1[_0x1cf80a(0x1c0)])('REDIS_CLIENT')),__metadata(_0x1cf80a(0x1d4),[Object])],RedisCacheService),exports[_0x1cf80a(0x1d9)]=RedisCacheService;