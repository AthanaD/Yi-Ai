'use strict';function _0x331b(_0x148256,_0x4bb0dd){const _0x2017ff=_0x2017();return _0x331b=function(_0x331bda,_0x34702b){_0x331bda=_0x331bda-0x104;let _0x76090f=_0x2017ff[_0x331bda];return _0x76090f;},_0x331b(_0x148256,_0x4bb0dd);}const _0x287378=_0x331b;(function(_0x2f4d95,_0x361b5b){const _0x5af4c6=_0x331b,_0x2262ca=_0x2f4d95();while(!![]){try{const _0x479320=parseInt(_0x5af4c6(0x11c))/0x1+parseInt(_0x5af4c6(0x132))/0x2*(-parseInt(_0x5af4c6(0x11d))/0x3)+parseInt(_0x5af4c6(0x12c))/0x4*(-parseInt(_0x5af4c6(0x12a))/0x5)+parseInt(_0x5af4c6(0x111))/0x6+parseInt(_0x5af4c6(0x114))/0x7+-parseInt(_0x5af4c6(0x133))/0x8*(-parseInt(_0x5af4c6(0x10a))/0x9)+-parseInt(_0x5af4c6(0x14c))/0xa;if(_0x479320===_0x361b5b)break;else _0x2262ca['push'](_0x2262ca['shift']());}catch(_0x2c0cb5){_0x2262ca['push'](_0x2262ca['shift']());}}}(_0x2017,0xb44d7));function _0x2017(){const _0x4f34ce=['event','UseGuards','__esModule','扫码登录轮询查询','扫码绑定轮询查询','@nestjs/swagger','echostr','./official.service','getRedirectUrl','scanBindWx','GetQrCodeDto','__decorate','officialScanLoginText','getQRCode','Req','officialSubscribeText','verify','获取二维码','text','loginByCode','genXmlMsg','12785220KhrpXl','code','@nestjs/common','__param','getJsapiTicket','JwtAuthGuard','content','公众号静默登录','decorate','env','获取登录跳转地址','Query','获取绑定二维码的sceneStr','defineProperty','Controller','bindWxBySceneStr','ApiOperation','getQRSceneStr','url','Post','sceneStr','includes','OfficialService','Res','./dto/getQrSceneStr.dto','status','__metadata','notifyPost','153NsOvBM','sceneStr:\x20','loginBySceneStr','official','officialService','SCAN','Body','4478094KJyZRZ','../../common/auth/jwtAuth.guard','signature','4989033rtSlkS','scan','./dto/getQrCode.dto','genXmlMsgByConfig','send','VIEW','msgtype','design:type','303597cnJnkh','480DmzEqY','subscribe','notify','OfficialController','获取注册配置','xml:\x20','aotoPlay','fromusername','prototype','design:paramtypes','公众号通知接口POST','getQRSceneStrByBind','design:returntype','2350955DmoGxq','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','4dsFbkb','ApiTags','log','getOwnPropertyDescriptor','CLICK','length','3606wlFoVO','476728SATLon','object','metadata','TRUE'];_0x2017=function(){return _0x4f34ce;};return _0x2017();}var __decorate=this&&this[_0x287378(0x142)]||function(_0x31b9a7,_0x31e9a9,_0x6a2f02,_0x186ddc){const _0x40a1b8=_0x287378;var _0x5b050f=arguments[_0x40a1b8(0x131)],_0xdd52d7=_0x5b050f<0x3?_0x31e9a9:_0x186ddc===null?_0x186ddc=Object[_0x40a1b8(0x12f)](_0x31e9a9,_0x6a2f02):_0x186ddc,_0x4e2aec;if(typeof Reflect===_0x40a1b8(0x134)&&typeof Reflect['decorate']==='function')_0xdd52d7=Reflect[_0x40a1b8(0x154)](_0x31b9a7,_0x31e9a9,_0x6a2f02,_0x186ddc);else{for(var _0x2d739d=_0x31b9a7[_0x40a1b8(0x131)]-0x1;_0x2d739d>=0x0;_0x2d739d--)if(_0x4e2aec=_0x31b9a7[_0x2d739d])_0xdd52d7=(_0x5b050f<0x3?_0x4e2aec(_0xdd52d7):_0x5b050f>0x3?_0x4e2aec(_0x31e9a9,_0x6a2f02,_0xdd52d7):_0x4e2aec(_0x31e9a9,_0x6a2f02))||_0xdd52d7;}return _0x5b050f>0x3&&_0xdd52d7&&Object['defineProperty'](_0x31e9a9,_0x6a2f02,_0xdd52d7),_0xdd52d7;},__metadata=this&&this[_0x287378(0x108)]||function(_0x81cbe7,_0x5d5c5a){const _0x62c53b=_0x287378;if(typeof Reflect==='object'&&typeof Reflect[_0x62c53b(0x135)]==='function')return Reflect['metadata'](_0x81cbe7,_0x5d5c5a);},__param=this&&this[_0x287378(0x14f)]||function(_0x3a2a7a,_0x4fc9b8){return function(_0x548d53,_0x463256){_0x4fc9b8(_0x548d53,_0x463256,_0x3a2a7a);};};Object[_0x287378(0x159)](exports,_0x287378(0x139),{'value':!![]}),exports[_0x287378(0x120)]=void 0x0;const common_1=require(_0x287378(0x14e)),swagger_1=require(_0x287378(0x13c)),jwtAuth_guard_1=require(_0x287378(0x112)),official_service_1=require(_0x287378(0x13e)),getQrCode_dto_1=require(_0x287378(0x116)),getQrSceneStr_dto_1=require(_0x287378(0x106));let OfficialController=class OfficialController{constructor(_0x356c82){const _0x84b659=_0x287378;this[_0x84b659(0x10e)]=_0x356c82;}async[_0x287378(0x11f)](_0x305b1b,_0x46c3b7,_0x29ebb9){const _0x50b27a=_0x287378;console[_0x50b27a(0x12e)]('get\x20通知>>>',_0x46c3b7,_0x29ebb9);const _0x1b1bc1=await this[_0x50b27a(0x10e)][_0x50b27a(0x147)](_0x46c3b7[_0x50b27a(0x113)],_0x46c3b7['nonce'],_0x46c3b7['timestamp']);return _0x1b1bc1?_0x46c3b7[_0x50b27a(0x13d)]:'';}async['notifyPost'](_0x4938ad,_0x4e0e6a,_0x418d14,_0x28a5c3){const _0x30428e=_0x287378,{xml:_0x3a6b3a}=_0x418d14;console[_0x30428e(0x12e)](_0x30428e(0x122),_0x3a6b3a);if(_0x3a6b3a[_0x30428e(0x11a)][0x0]=='event'){if(_0x3a6b3a['event'][0x0]==_0x30428e(0x119)||_0x3a6b3a[_0x30428e(0x137)][0x0]==_0x30428e(0x130))return _0x28a5c3[_0x30428e(0x107)](0xc8)[_0x30428e(0x118)]('');if(_0x3a6b3a[_0x30428e(0x137)][0x0]==_0x30428e(0x10f)){console['log']('扫码');const _0x341198=_0x3a6b3a['eventkey'][0x0];if(_0x341198[_0x30428e(0x161)]('/')){this[_0x30428e(0x10e)]['scanBindWx'](_0x3a6b3a['fromusername'][0x0],_0x341198);const _0x2b5880=await this[_0x30428e(0x10e)][_0x30428e(0x117)](_0x3a6b3a,'officialBindAccountText');return _0x28a5c3[_0x30428e(0x107)](0xc8)['send'](_0x2b5880);}this[_0x30428e(0x10e)][_0x30428e(0x115)](_0x3a6b3a[_0x30428e(0x124)][0x0],_0x341198);const _0x1ab601=await this['officialService'][_0x30428e(0x117)](_0x3a6b3a,_0x30428e(0x143));return _0x28a5c3['status'](0xc8)[_0x30428e(0x118)](_0x1ab601);}if(_0x3a6b3a[_0x30428e(0x137)][0x0]==_0x30428e(0x11e)){console[_0x30428e(0x12e)]('订阅',_0x3a6b3a['eventkey'][0x0]);const _0x27c7e6=_0x3a6b3a['eventkey'][0x0]['split']('qrscene_')[0x1];console[_0x30428e(0x12e)](_0x30428e(0x10b),_0x27c7e6);if(!_0x27c7e6){const _0x92cfe6=await this[_0x30428e(0x10e)]['genXmlMsgByConfig'](_0x3a6b3a,'officialSubscribeText');return _0x28a5c3[_0x30428e(0x107)](0xc8)[_0x30428e(0x118)](_0x92cfe6);}if(_0x27c7e6[_0x30428e(0x161)]('/')){this[_0x30428e(0x10e)][_0x30428e(0x140)](_0x3a6b3a[_0x30428e(0x124)][0x0],_0x27c7e6);const _0x1f09d7=await this['officialService'][_0x30428e(0x117)](_0x3a6b3a,'officialBindAccountText');return _0x28a5c3[_0x30428e(0x107)](0xc8)[_0x30428e(0x118)](_0x1f09d7);}this[_0x30428e(0x10e)][_0x30428e(0x115)](_0x3a6b3a['fromusername'][0x0],_0x27c7e6);const _0x588713=await this[_0x30428e(0x10e)][_0x30428e(0x117)](_0x3a6b3a,_0x30428e(0x146));return _0x28a5c3[_0x30428e(0x107)](0xc8)[_0x30428e(0x118)](_0x588713);}if(_0x3a6b3a[_0x30428e(0x137)][0x0]=='unsubscribe')return _0x28a5c3['status'](0xc8)['send']('');}if(_0x3a6b3a['msgtype'][0x0]==_0x30428e(0x149)){const _0x31688d=await this[_0x30428e(0x10e)][_0x30428e(0x123)](_0x3a6b3a[_0x30428e(0x152)][0x0]),_0x4acb=await this[_0x30428e(0x10e)][_0x30428e(0x14b)](_0x3a6b3a,_0x31688d);return _0x28a5c3['status'](0xc8)['send'](_0x4acb);}return'success';}async[_0x287378(0x15d)](_0x5cca89){const _0x38425c=_0x287378;return this['officialService'][_0x38425c(0x15d)](_0x5cca89);}async[_0x287378(0x128)](_0x576136){const _0x172581=_0x287378;return this[_0x172581(0x10e)][_0x172581(0x128)](_0x576136);}async[_0x287378(0x144)](_0x164f12){const _0x5e7595=_0x287378;if(process[_0x5e7595(0x155)]['ISDEV']===_0x5e7595(0x136))return'';const _0x166a4c=await this[_0x5e7595(0x10e)]['getQRCodeTicket'](_0x164f12['sceneStr']);return _0x5e7595(0x12b)+encodeURIComponent(_0x166a4c);}async[_0x287378(0x10c)](_0x1d3bc9,_0x3f1f46){const _0x3c66cf=_0x287378;return this[_0x3c66cf(0x10e)]['loginBySceneStr'](_0x1d3bc9,_0x3f1f46[_0x3c66cf(0x160)]);}async[_0x287378(0x15b)](_0x2180b4,_0x5deb44){const _0x942000=_0x287378;return this[_0x942000(0x10e)][_0x942000(0x15b)](_0x2180b4,_0x5deb44[_0x942000(0x160)]);}async[_0x287378(0x13f)](_0x8d207c){const _0x275e5d=_0x287378;return this[_0x275e5d(0x10e)][_0x275e5d(0x13f)](_0x8d207c[_0x275e5d(0x15e)]);}async[_0x287378(0x150)](_0x221eb3){const _0x34a503=_0x287378;return this[_0x34a503(0x10e)][_0x34a503(0x150)](_0x221eb3[_0x34a503(0x15e)]);}async['loginByCode'](_0x5bbb53,_0x5874a7){const _0x18ec2e=_0x287378;return this[_0x18ec2e(0x10e)]['loginByCode'](_0x5bbb53,_0x5874a7[_0x18ec2e(0x14d)]);}};__decorate([(0x0,common_1['Get'])('notify'),(0x0,swagger_1['ApiOperation'])({'summary':'公众号通知接口GET'}),__param(0x0,(0x0,common_1[_0x287378(0x145)])()),__param(0x1,(0x0,common_1[_0x287378(0x157)])()),__param(0x2,(0x0,common_1[_0x287378(0x110)])()),__metadata(_0x287378(0x11b),Function),__metadata('design:paramtypes',[Object,Object,Object]),__metadata('design:returntype',Promise)],OfficialController['prototype'],_0x287378(0x11f),null),__decorate([(0x0,common_1[_0x287378(0x15f)])(_0x287378(0x11f)),(0x0,swagger_1[_0x287378(0x15c)])({'summary':_0x287378(0x127)}),__param(0x0,(0x0,common_1[_0x287378(0x145)])()),__param(0x1,(0x0,common_1['Query'])()),__param(0x2,(0x0,common_1[_0x287378(0x110)])()),__param(0x3,(0x0,common_1[_0x287378(0x105)])()),__metadata(_0x287378(0x11b),Function),__metadata(_0x287378(0x126),[Object,Object,Object,Object]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],_0x287378(0x109),null),__decorate([(0x0,common_1[_0x287378(0x15f)])('getQRSceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':'获取登录二维码sceneStr'}),__param(0x0,(0x0,common_1[_0x287378(0x110)])()),__metadata(_0x287378(0x11b),Function),__metadata(_0x287378(0x126),[getQrSceneStr_dto_1['GetQrSceneStrDto']]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x287378(0x15f)])(_0x287378(0x128)),(0x0,swagger_1['ApiOperation'])({'summary':_0x287378(0x158)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1['JwtAuthGuard']),__param(0x0,(0x0,common_1[_0x287378(0x145)])()),__metadata(_0x287378(0x11b),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x287378(0x129),Promise)],OfficialController['prototype'],_0x287378(0x128),null),__decorate([(0x0,common_1['Get'])('getQRCode'),(0x0,swagger_1[_0x287378(0x15c)])({'summary':_0x287378(0x148)}),__param(0x0,(0x0,common_1[_0x287378(0x157)])()),__metadata(_0x287378(0x11b),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x287378(0x141)]]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],'getQRCode',null),__decorate([(0x0,common_1[_0x287378(0x15f)])(_0x287378(0x10c)),(0x0,swagger_1['ApiOperation'])({'summary':_0x287378(0x13a)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x287378(0x11b),Function),__metadata(_0x287378(0x126),[Object,getQrCode_dto_1[_0x287378(0x141)]]),__metadata(_0x287378(0x129),Promise)],OfficialController['prototype'],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x287378(0x15f)])('bindWxBySceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x287378(0x13b)}),(0x0,common_1[_0x287378(0x138)])(jwtAuth_guard_1[_0x287378(0x151)]),__param(0x0,(0x0,common_1[_0x287378(0x145)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x287378(0x126),[Object,getQrCode_dto_1[_0x287378(0x141)]]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],_0x287378(0x15b),null),__decorate([(0x0,common_1[_0x287378(0x15f)])('getRedirectUrl'),(0x0,swagger_1[_0x287378(0x15c)])({'summary':_0x287378(0x156)}),__param(0x0,(0x0,common_1[_0x287378(0x110)])()),__metadata(_0x287378(0x11b),Function),__metadata(_0x287378(0x126),[Object]),__metadata(_0x287378(0x129),Promise)],OfficialController['prototype'],_0x287378(0x13f),null),__decorate([(0x0,common_1['Post'])(_0x287378(0x150)),(0x0,swagger_1[_0x287378(0x15c)])({'summary':_0x287378(0x121)}),__param(0x0,(0x0,common_1[_0x287378(0x110)])()),__metadata('design:type',Function),__metadata(_0x287378(0x126),[Object]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],'getJsapiTicket',null),__decorate([(0x0,common_1[_0x287378(0x15f)])(_0x287378(0x14a)),(0x0,swagger_1[_0x287378(0x15c)])({'summary':_0x287378(0x153)}),__param(0x0,(0x0,common_1[_0x287378(0x145)])()),__param(0x1,(0x0,common_1[_0x287378(0x110)])()),__metadata(_0x287378(0x11b),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x287378(0x129),Promise)],OfficialController[_0x287378(0x125)],_0x287378(0x14a),null),OfficialController=__decorate([(0x0,swagger_1[_0x287378(0x12d)])(_0x287378(0x10d)),(0x0,common_1[_0x287378(0x15a)])('official'),__metadata(_0x287378(0x126),[official_service_1[_0x287378(0x104)]])],OfficialController),exports[_0x287378(0x120)]=OfficialController;