'use strict';const _0x294953=_0x4e4c;(function(_0x282f95,_0xa110b8){const _0x284a0d=_0x4e4c,_0x517655=_0x282f95();while(!![]){try{const _0x4c1f5c=parseInt(_0x284a0d(0x11f))/0x1+-parseInt(_0x284a0d(0x11c))/0x2*(parseInt(_0x284a0d(0x167))/0x3)+-parseInt(_0x284a0d(0x174))/0x4*(-parseInt(_0x284a0d(0x17b))/0x5)+parseInt(_0x284a0d(0x124))/0x6*(-parseInt(_0x284a0d(0x13b))/0x7)+-parseInt(_0x284a0d(0x156))/0x8*(parseInt(_0x284a0d(0x170))/0x9)+-parseInt(_0x284a0d(0x123))/0xa+parseInt(_0x284a0d(0x125))/0xb;if(_0x4c1f5c===_0xa110b8)break;else _0x517655['push'](_0x517655['shift']());}catch(_0x1f8687){_0x517655['push'](_0x517655['shift']());}}}(_0x4439,0x215ec));function _0x4e4c(_0x3b2b2b,_0x21136d){const _0x4439e7=_0x4439();return _0x4e4c=function(_0x4e4c1a,_0x3faf20){_0x4e4c1a=_0x4e4c1a-0x11c;let _0x2102df=_0x4439e7[_0x4e4c1a];return _0x2102df;},_0x4e4c(_0x3b2b2b,_0x21136d);}function _0x4439(){const _0x291c49=['loginByCode','https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=','@nestjs/common','../../common/auth/jwtAuth.guard','5snPkrk','./dto/getQrCode.dto','公众号通知接口GET','fromusername','63828cgKVBG','url','__metadata','17964XwvKwa','VIEW','ApiOperation','./dto/getQrSceneStr.dto','450030fWuIre','6zrpxcp','6266755kzCVLl','subscribe','design:paramtypes','log','verify','defineProperty','__param','获取二维码','获取登录跳转地址','text','send','getRedirectUrl','design:returntype','code','GetQrCodeDto','eventkey','getQRCode','sceneStr','获取注册配置','object','Body','CLICK','901061LAdHrO','获取绑定二维码的sceneStr','ApiTags','design:type','Res','genXmlMsg','length','scanBindWx','notifyPost','loginBySceneStr','genXmlMsgByConfig','timestamp','./official.service','扫码绑定轮询查询','aotoPlay','getQRSceneStr','__decorate','TRUE','获取登录二维码sceneStr','getQRSceneStrByBind','status','bindWxBySceneStr','扫码登录轮询查询','metadata','env','xml:\x20','Get','6432TOOkbd','Controller','decorate','ISDEV','officialService','official','event','includes','Post','getJsapiTicket','prototype','content','function','echostr','__esModule','Query','公众号通知接口POST','24eJoaEV','OfficialController','@nestjs/swagger','notify','success','GetQrSceneStrDto','msgtype','UseGuards','scan','2088fIitIS','qrscene_','Req','公众号静默登录','658324EMqTHS','JwtAuthGuard','officialBindAccountText'];_0x4439=function(){return _0x291c49;};return _0x4439();}var __decorate=this&&this[_0x294953(0x14b)]||function(_0x16a98a,_0xd01ffb,_0x21dc4b,_0x13b1eb){const _0x3f4a58=_0x294953;var _0x241073=arguments[_0x3f4a58(0x141)],_0x178f73=_0x241073<0x3?_0xd01ffb:_0x13b1eb===null?_0x13b1eb=Object['getOwnPropertyDescriptor'](_0xd01ffb,_0x21dc4b):_0x13b1eb,_0x438268;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x178f73=Reflect[_0x3f4a58(0x158)](_0x16a98a,_0xd01ffb,_0x21dc4b,_0x13b1eb);else{for(var _0x41998a=_0x16a98a[_0x3f4a58(0x141)]-0x1;_0x41998a>=0x0;_0x41998a--)if(_0x438268=_0x16a98a[_0x41998a])_0x178f73=(_0x241073<0x3?_0x438268(_0x178f73):_0x241073>0x3?_0x438268(_0xd01ffb,_0x21dc4b,_0x178f73):_0x438268(_0xd01ffb,_0x21dc4b))||_0x178f73;}return _0x241073>0x3&&_0x178f73&&Object['defineProperty'](_0xd01ffb,_0x21dc4b,_0x178f73),_0x178f73;},__metadata=this&&this[_0x294953(0x11e)]||function(_0x3bf4a7,_0x51c1c6){const _0x41e4c7=_0x294953;if(typeof Reflect===_0x41e4c7(0x138)&&typeof Reflect['metadata']===_0x41e4c7(0x162))return Reflect[_0x41e4c7(0x152)](_0x3bf4a7,_0x51c1c6);},__param=this&&this[_0x294953(0x12b)]||function(_0x11a3a3,_0x235d4f){return function(_0x1b9de0,_0x325788){_0x235d4f(_0x1b9de0,_0x325788,_0x11a3a3);};};Object[_0x294953(0x12a)](exports,_0x294953(0x164),{'value':!![]}),exports[_0x294953(0x168)]=void 0x0;const common_1=require(_0x294953(0x179)),swagger_1=require(_0x294953(0x169)),jwtAuth_guard_1=require(_0x294953(0x17a)),official_service_1=require(_0x294953(0x147)),getQrCode_dto_1=require(_0x294953(0x17c)),getQrSceneStr_dto_1=require(_0x294953(0x122));let OfficialController=class OfficialController{constructor(_0x5a2328){this['officialService']=_0x5a2328;}async[_0x294953(0x16a)](_0x898b42,_0xed24be,_0x37128c){const _0x22731e=_0x294953;console[_0x22731e(0x128)]('get\x20通知>>>',_0xed24be,_0x37128c);const _0x994114=await this[_0x22731e(0x15a)][_0x22731e(0x129)](_0xed24be['signature'],_0xed24be['nonce'],_0xed24be[_0x22731e(0x146)]);return _0x994114?_0xed24be[_0x22731e(0x163)]:'';}async['notifyPost'](_0x29228a,_0x3443f5,_0x52a07a,_0x260ede){const _0x2f011f=_0x294953,{xml:_0x10b125}=_0x52a07a;console[_0x2f011f(0x128)](_0x2f011f(0x154),_0x10b125);if(_0x10b125[_0x2f011f(0x16d)][0x0]=='event'){if(_0x10b125[_0x2f011f(0x15c)][0x0]==_0x2f011f(0x120)||_0x10b125['event'][0x0]==_0x2f011f(0x13a))return _0x260ede['status'](0xc8)[_0x2f011f(0x12f)]('');if(_0x10b125['event'][0x0]=='SCAN'){console[_0x2f011f(0x128)]('扫码');const _0x1a6e9a=_0x10b125[_0x2f011f(0x134)][0x0];if(_0x1a6e9a['includes']('/')){this['officialService'][_0x2f011f(0x142)](_0x10b125[_0x2f011f(0x17e)][0x0],_0x1a6e9a);const _0x2d1bb1=await this[_0x2f011f(0x15a)][_0x2f011f(0x145)](_0x10b125,_0x2f011f(0x176));return _0x260ede[_0x2f011f(0x14f)](0xc8)['send'](_0x2d1bb1);}this['officialService']['scan'](_0x10b125[_0x2f011f(0x17e)][0x0],_0x1a6e9a);const _0xe5bfd5=await this[_0x2f011f(0x15a)]['genXmlMsgByConfig'](_0x10b125,'officialScanLoginText');return _0x260ede[_0x2f011f(0x14f)](0xc8)['send'](_0xe5bfd5);}if(_0x10b125[_0x2f011f(0x15c)][0x0]==_0x2f011f(0x126)){console['log']('订阅',_0x10b125['eventkey'][0x0]);const _0x38a7a5=_0x10b125['eventkey'][0x0]['split'](_0x2f011f(0x171))[0x1];console[_0x2f011f(0x128)]('sceneStr:\x20',_0x38a7a5);if(!_0x38a7a5){const _0x5e80b6=await this[_0x2f011f(0x15a)][_0x2f011f(0x145)](_0x10b125,'officialSubscribeText');return _0x260ede['status'](0xc8)[_0x2f011f(0x12f)](_0x5e80b6);}if(_0x38a7a5[_0x2f011f(0x15d)]('/')){this[_0x2f011f(0x15a)][_0x2f011f(0x142)](_0x10b125[_0x2f011f(0x17e)][0x0],_0x38a7a5);const _0x405d5a=await this[_0x2f011f(0x15a)]['genXmlMsgByConfig'](_0x10b125,_0x2f011f(0x176));return _0x260ede[_0x2f011f(0x14f)](0xc8)[_0x2f011f(0x12f)](_0x405d5a);}this[_0x2f011f(0x15a)][_0x2f011f(0x16f)](_0x10b125[_0x2f011f(0x17e)][0x0],_0x38a7a5);const _0x195a9e=await this[_0x2f011f(0x15a)][_0x2f011f(0x145)](_0x10b125,'officialSubscribeText');return _0x260ede['status'](0xc8)[_0x2f011f(0x12f)](_0x195a9e);}if(_0x10b125[_0x2f011f(0x15c)][0x0]=='unsubscribe')return _0x260ede[_0x2f011f(0x14f)](0xc8)[_0x2f011f(0x12f)]('');}if(_0x10b125['msgtype'][0x0]==_0x2f011f(0x12e)){const _0x57d5ba=await this[_0x2f011f(0x15a)][_0x2f011f(0x149)](_0x10b125[_0x2f011f(0x161)][0x0]),_0x554b62=await this[_0x2f011f(0x15a)][_0x2f011f(0x140)](_0x10b125,_0x57d5ba);return _0x260ede[_0x2f011f(0x14f)](0xc8)['send'](_0x554b62);}return _0x2f011f(0x16b);}async[_0x294953(0x14a)](_0x44fd39){const _0x3ec82c=_0x294953;return this[_0x3ec82c(0x15a)][_0x3ec82c(0x14a)](_0x44fd39);}async['getQRSceneStrByBind'](_0x11d59c){const _0x2a6f36=_0x294953;return this[_0x2a6f36(0x15a)][_0x2a6f36(0x14e)](_0x11d59c);}async['getQRCode'](_0x521b81){const _0x2ca233=_0x294953;if(process[_0x2ca233(0x153)][_0x2ca233(0x159)]===_0x2ca233(0x14c))return'';const _0x5a25da=await this[_0x2ca233(0x15a)]['getQRCodeTicket'](_0x521b81[_0x2ca233(0x136)]);return _0x2ca233(0x178)+encodeURIComponent(_0x5a25da);}async[_0x294953(0x144)](_0x43de7e,_0x2c2021){const _0x418968=_0x294953;return this[_0x418968(0x15a)][_0x418968(0x144)](_0x43de7e,_0x2c2021[_0x418968(0x136)]);}async['bindWxBySceneStr'](_0x4467b5,_0x87e1e8){const _0x383df2=_0x294953;return this['officialService'][_0x383df2(0x150)](_0x4467b5,_0x87e1e8['sceneStr']);}async[_0x294953(0x130)](_0x2d659a){const _0x2fa71d=_0x294953;return this[_0x2fa71d(0x15a)][_0x2fa71d(0x130)](_0x2d659a['url']);}async['getJsapiTicket'](_0x15af4a){const _0x9f5c00=_0x294953;return this['officialService'][_0x9f5c00(0x15f)](_0x15af4a[_0x9f5c00(0x11d)]);}async[_0x294953(0x177)](_0x5ccd5b,_0x4d8c2d){const _0x10c4c3=_0x294953;return this[_0x10c4c3(0x15a)][_0x10c4c3(0x177)](_0x5ccd5b,_0x4d8c2d[_0x10c4c3(0x132)]);}};__decorate([(0x0,common_1[_0x294953(0x155)])(_0x294953(0x16a)),(0x0,swagger_1['ApiOperation'])({'summary':_0x294953(0x17d)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x294953(0x165)])()),__param(0x2,(0x0,common_1[_0x294953(0x139)])()),__metadata('design:type',Function),__metadata(_0x294953(0x127),[Object,Object,Object]),__metadata(_0x294953(0x131),Promise)],OfficialController['prototype'],_0x294953(0x16a),null),__decorate([(0x0,common_1[_0x294953(0x15e)])(_0x294953(0x16a)),(0x0,swagger_1['ApiOperation'])({'summary':_0x294953(0x166)}),__param(0x0,(0x0,common_1['Req'])()),__param(0x1,(0x0,common_1[_0x294953(0x165)])()),__param(0x2,(0x0,common_1['Body'])()),__param(0x3,(0x0,common_1[_0x294953(0x13f)])()),__metadata(_0x294953(0x13e),Function),__metadata(_0x294953(0x127),[Object,Object,Object,Object]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],_0x294953(0x143),null),__decorate([(0x0,common_1[_0x294953(0x15e)])(_0x294953(0x14a)),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x14d)}),__param(0x0,(0x0,common_1[_0x294953(0x139)])()),__metadata(_0x294953(0x13e),Function),__metadata('design:paramtypes',[getQrSceneStr_dto_1[_0x294953(0x16c)]]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],'getQRSceneStr',null),__decorate([(0x0,common_1[_0x294953(0x15e)])('getQRSceneStrByBind'),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x13c)}),(0x0,common_1[_0x294953(0x16e)])(jwtAuth_guard_1[_0x294953(0x175)]),__param(0x0,(0x0,common_1['Req'])()),__metadata('design:type',Function),__metadata(_0x294953(0x127),[Object]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],'getQRSceneStrByBind',null),__decorate([(0x0,common_1['Get'])('getQRCode'),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x12c)}),__param(0x0,(0x0,common_1[_0x294953(0x165)])()),__metadata(_0x294953(0x13e),Function),__metadata('design:paramtypes',[getQrCode_dto_1[_0x294953(0x133)]]),__metadata('design:returntype',Promise)],OfficialController[_0x294953(0x160)],_0x294953(0x135),null),__decorate([(0x0,common_1['Post'])('loginBySceneStr'),(0x0,swagger_1['ApiOperation'])({'summary':_0x294953(0x151)}),__param(0x0,(0x0,common_1[_0x294953(0x172)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata('design:type',Function),__metadata(_0x294953(0x127),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata('design:returntype',Promise)],OfficialController[_0x294953(0x160)],'loginBySceneStr',null),__decorate([(0x0,common_1[_0x294953(0x15e)])('bindWxBySceneStr'),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x148)}),(0x0,common_1['UseGuards'])(jwtAuth_guard_1[_0x294953(0x175)]),__param(0x0,(0x0,common_1[_0x294953(0x172)])()),__param(0x1,(0x0,common_1['Body'])()),__metadata(_0x294953(0x13e),Function),__metadata(_0x294953(0x127),[Object,getQrCode_dto_1['GetQrCodeDto']]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],_0x294953(0x150),null),__decorate([(0x0,common_1[_0x294953(0x15e)])(_0x294953(0x130)),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x12d)}),__param(0x0,(0x0,common_1[_0x294953(0x139)])()),__metadata(_0x294953(0x13e),Function),__metadata(_0x294953(0x127),[Object]),__metadata('design:returntype',Promise)],OfficialController[_0x294953(0x160)],'getRedirectUrl',null),__decorate([(0x0,common_1['Post'])('getJsapiTicket'),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x137)}),__param(0x0,(0x0,common_1[_0x294953(0x139)])()),__metadata(_0x294953(0x13e),Function),__metadata(_0x294953(0x127),[Object]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],_0x294953(0x15f),null),__decorate([(0x0,common_1[_0x294953(0x15e)])(_0x294953(0x177)),(0x0,swagger_1[_0x294953(0x121)])({'summary':_0x294953(0x173)}),__param(0x0,(0x0,common_1[_0x294953(0x172)])()),__param(0x1,(0x0,common_1[_0x294953(0x139)])()),__metadata('design:type',Function),__metadata(_0x294953(0x127),[Object,Object]),__metadata(_0x294953(0x131),Promise)],OfficialController[_0x294953(0x160)],_0x294953(0x177),null),OfficialController=__decorate([(0x0,swagger_1[_0x294953(0x13d)])(_0x294953(0x15b)),(0x0,common_1[_0x294953(0x157)])('official'),__metadata(_0x294953(0x127),[official_service_1['OfficialService']])],OfficialController),exports[_0x294953(0x168)]=OfficialController;