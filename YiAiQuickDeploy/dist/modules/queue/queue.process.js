'use strict';var _0x374838=_0x1a1c;function _0x106e(){var _0x515983=['handleJob','48786iwADZp','OnQueueError','length','695agdwCV','onQueueProgress','1100814izhtCI','MidjourneyService','\x20jobs\x20of\x20type\x20','onQueueResumed','metadata','1332muSkNI','onQueueCompleted','data','onQueueDrained','@nestjs/bull','logger','defineProperty','Logger','1017992MxFzcd','2rvMVCN','OnQueueFailed','QueueProcessor',':\x20绘画失败\x20','\x20were\x20cleaned.','midjourneyService','prototype','onQueueError','15248651webgAB','design:type','56EDDUbz','994131dBBEWb','onQueueFailed','116330USzGvv','onQueueActive','onQueuePaused','__metadata','design:returntype','MJDRAW','drawFailed','5303696efkSGn','onQueueCleaned','OnQueueProgress','OnQueueCleaned','object','Queue\x20failed:\x20','function','CONCURRENCY','env','decorate','OnQueueActive','error','log','队列发生错误','design:paramtypes','OnQueueDrained','getOwnPropertyDescriptor','__decorate','OnQueueResumed','message','mjDraw'];_0x106e=function(){return _0x515983;};return _0x106e();}(function(_0x393e07,_0x1564d1){var _0x4a041c=_0x1a1c,_0x58ff47=_0x393e07();while(!![]){try{var _0x26b0f1=parseInt(_0x4a041c(0x1b0))/0x1*(parseInt(_0x4a041c(0x1a5))/0x2)+parseInt(_0x4a041c(0x1d4))/0x3+parseInt(_0x4a041c(0x1b9))/0x4+-parseInt(_0x4a041c(0x1d2))/0x5*(parseInt(_0x4a041c(0x1cf))/0x6)+parseInt(_0x4a041c(0x1af))/0x7*(-parseInt(_0x4a041c(0x1a4))/0x8)+parseInt(_0x4a041c(0x1d9))/0x9*(parseInt(_0x4a041c(0x1b2))/0xa)+-parseInt(_0x4a041c(0x1ad))/0xb;if(_0x26b0f1===_0x1564d1)break;else _0x58ff47['push'](_0x58ff47['shift']());}catch(_0x4b853c){_0x58ff47['push'](_0x58ff47['shift']());}}}(_0x106e,0xd56fb));var __decorate=this&&this[_0x374838(0x1ca)]||function(_0x10dec2,_0x1f1b05,_0xb6e344,_0x52d897){var _0x15ee75=_0x374838,_0x2650a7=arguments[_0x15ee75(0x1d1)],_0x164dde=_0x2650a7<0x3?_0x1f1b05:_0x52d897===null?_0x52d897=Object[_0x15ee75(0x1c9)](_0x1f1b05,_0xb6e344):_0x52d897,_0x52a34a;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x164dde=Reflect[_0x15ee75(0x1c2)](_0x10dec2,_0x1f1b05,_0xb6e344,_0x52d897);else{for(var _0x3e6d8c=_0x10dec2[_0x15ee75(0x1d1)]-0x1;_0x3e6d8c>=0x0;_0x3e6d8c--)if(_0x52a34a=_0x10dec2[_0x3e6d8c])_0x164dde=(_0x2650a7<0x3?_0x52a34a(_0x164dde):_0x2650a7>0x3?_0x52a34a(_0x1f1b05,_0xb6e344,_0x164dde):_0x52a34a(_0x1f1b05,_0xb6e344))||_0x164dde;}return _0x2650a7>0x3&&_0x164dde&&Object[_0x15ee75(0x1df)](_0x1f1b05,_0xb6e344,_0x164dde),_0x164dde;},__metadata=this&&this[_0x374838(0x1b5)]||function(_0x30ecb9,_0x44e785){var _0x54fe42=_0x374838;if(typeof Reflect===_0x54fe42(0x1bd)&&typeof Reflect[_0x54fe42(0x1d8)]===_0x54fe42(0x1bf))return Reflect[_0x54fe42(0x1d8)](_0x30ecb9,_0x44e785);},QueueProcessor_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[_0x374838(0x1a7)]=void 0x0;const bull_1=require(_0x374838(0x1dd)),common_1=require('@nestjs/common'),midjourney_service_1=require('../midjourney/midjourney.service');let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x5e9ca2){var _0x3db588=_0x374838;this[_0x3db588(0x1aa)]=_0x5e9ca2,this[_0x3db588(0x1de)]=new common_1[(_0x3db588(0x1a3))](QueueProcessor_1['name']);}async[_0x374838(0x1ce)](_0x910537){var _0x5da1dd=_0x374838;const _0x34c6b7=await this[_0x5da1dd(0x1aa)]['draw'](_0x910537[_0x5da1dd(0x1db)],_0x910537['id']);return _0x34c6b7;}[_0x374838(0x1b3)](_0x47488a){}[_0x374838(0x1ac)](_0x135d87){var _0x1a4bfa=_0x374838;console[_0x1a4bfa(0x1c5)](_0x1a4bfa(0x1c6),_0x135d87);}[_0x374838(0x1d3)](_0x4fe144,_0x5a270d){var _0x5e0a72=_0x374838;console[_0x5e0a72(0x1c5)]('队列任务的一个回调用于通知当前进度',_0x4fe144['id'],_0x5a270d);}[_0x374838(0x1da)](_0x5e96e8,_0x4fbf7a){}[_0x374838(0x1b1)](_0x1bfdf0,_0x483f9c){var _0x1c30d3=_0x374838;common_1[_0x1c30d3(0x1a3)][_0x1c30d3(0x1c4)](_0x1c30d3(0x1be)+_0x483f9c[_0x1c30d3(0x1cc)]+_0x1c30d3(0x1a8)+_0x1bfdf0['id'],_0x1c30d3(0x1a7)),this[_0x1c30d3(0x1aa)][_0x1c30d3(0x1b8)](_0x1bfdf0[_0x1c30d3(0x1db)]);}[_0x374838(0x1b4)](){var _0x2a9e81=_0x374838;console[_0x2a9e81(0x1c5)]('队列暂停的时候调用');}[_0x374838(0x1d7)](){var _0x32efe5=_0x374838;console[_0x32efe5(0x1c5)]('队列恢复的时候调用');}[_0x374838(0x1ba)](_0x26f38,_0x154a89){var _0x8c697a=_0x374838;common_1['Logger'][_0x8c697a(0x1c5)]('Queue\x20cleaned:\x20'+_0x26f38[_0x8c697a(0x1d1)]+_0x8c697a(0x1d6)+_0x154a89+_0x8c697a(0x1a9),_0x8c697a(0x1a7));}[_0x374838(0x1dc)](){}};function _0x1a1c(_0x39e6b9,_0x57e41f){var _0x106eb0=_0x106e();return _0x1a1c=function(_0x1a1c7f,_0x25e3d3){_0x1a1c7f=_0x1a1c7f-0x1a3;var _0x30bdb6=_0x106eb0[_0x1a1c7f];return _0x30bdb6;},_0x1a1c(_0x39e6b9,_0x57e41f);}__decorate([(0x0,bull_1['Process'])({'name':_0x374838(0x1cd),'concurrency':process[_0x374838(0x1c1)][_0x374838(0x1c0)]?+process[_0x374838(0x1c1)][_0x374838(0x1c0)]:0x3}),__metadata(_0x374838(0x1ae),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x374838(0x1b6),Promise)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1ce),null),__decorate([(0x0,bull_1[_0x374838(0x1c3)])(),__metadata(_0x374838(0x1ae),Function),__metadata(_0x374838(0x1c7),[Object]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1b3),null),__decorate([(0x0,bull_1[_0x374838(0x1d0)])(),__metadata(_0x374838(0x1ae),Function),__metadata('design:paramtypes',[Error]),__metadata(_0x374838(0x1b6),void 0x0)],QueueProcessor[_0x374838(0x1ab)],'onQueueError',null),__decorate([(0x0,bull_1[_0x374838(0x1bb)])(),__metadata('design:type',Function),__metadata(_0x374838(0x1c7),[Object,Number]),__metadata(_0x374838(0x1b6),void 0x0)],QueueProcessor[_0x374838(0x1ab)],'onQueueProgress',null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x374838(0x1ae),Function),__metadata(_0x374838(0x1c7),[Object,Object]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],'onQueueCompleted',null),__decorate([(0x0,bull_1[_0x374838(0x1a6)])(),__metadata(_0x374838(0x1ae),Function),__metadata(_0x374838(0x1c7),[Object,Error]),__metadata(_0x374838(0x1b6),void 0x0)],QueueProcessor[_0x374838(0x1ab)],'onQueueFailed',null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata(_0x374838(0x1ae),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1b4),null),__decorate([(0x0,bull_1[_0x374838(0x1cb)])(),__metadata('design:type',Function),__metadata(_0x374838(0x1c7),[]),__metadata(_0x374838(0x1b6),void 0x0)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1d7),null),__decorate([(0x0,bull_1[_0x374838(0x1bc)])(),__metadata(_0x374838(0x1ae),Function),__metadata('design:paramtypes',[Array,String]),__metadata(_0x374838(0x1b6),void 0x0)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1ba),null),__decorate([(0x0,bull_1[_0x374838(0x1c8)])(),__metadata(_0x374838(0x1ae),Function),__metadata(_0x374838(0x1c7),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x374838(0x1ab)],_0x374838(0x1dc),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1['Processor'])(_0x374838(0x1b7)),__metadata('design:paramtypes',[midjourney_service_1[_0x374838(0x1d5)]])],QueueProcessor),exports[_0x374838(0x1a7)]=QueueProcessor;