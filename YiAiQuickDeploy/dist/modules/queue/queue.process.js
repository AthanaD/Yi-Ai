'use strict';var _0x51fcd6=_0x2fb6;(function(_0x14efeb,_0x27f631){var _0xcca3e2=_0x2fb6,_0xd3131c=_0x14efeb();while(!![]){try{var _0x2c13b0=-parseInt(_0xcca3e2(0x113))/0x1+parseInt(_0xcca3e2(0x106))/0x2*(-parseInt(_0xcca3e2(0x10e))/0x3)+parseInt(_0xcca3e2(0x12d))/0x4*(parseInt(_0xcca3e2(0x108))/0x5)+parseInt(_0xcca3e2(0x10b))/0x6*(-parseInt(_0xcca3e2(0x107))/0x7)+parseInt(_0xcca3e2(0x133))/0x8*(-parseInt(_0xcca3e2(0x121))/0x9)+-parseInt(_0xcca3e2(0x125))/0xa*(parseInt(_0xcca3e2(0x130))/0xb)+-parseInt(_0xcca3e2(0x128))/0xc*(-parseInt(_0xcca3e2(0x10f))/0xd);if(_0x2c13b0===_0x27f631)break;else _0xd3131c['push'](_0xd3131c['shift']());}catch(_0x3d1274){_0xd3131c['push'](_0xd3131c['shift']());}}}(_0x1323,0x4a07a));function _0x2fb6(_0x1b18ef,_0x252b60){var _0x132382=_0x1323();return _0x2fb6=function(_0x2fb6fb,_0x331f57){_0x2fb6fb=_0x2fb6fb-0xfc;var _0x3d61dc=_0x132382[_0x2fb6fb];return _0x3d61dc;},_0x2fb6(_0x1b18ef,_0x252b60);}var __decorate=this&&this[_0x51fcd6(0xfd)]||function(_0x262675,_0x1ea4c3,_0x2557b1,_0x27146d){var _0x5372e5=_0x51fcd6,_0x3c434e=arguments[_0x5372e5(0x127)],_0x256d57=_0x3c434e<0x3?_0x1ea4c3:_0x27146d===null?_0x27146d=Object[_0x5372e5(0xff)](_0x1ea4c3,_0x2557b1):_0x27146d,_0x1c635f;if(typeof Reflect===_0x5372e5(0x115)&&typeof Reflect[_0x5372e5(0x10c)]==='function')_0x256d57=Reflect[_0x5372e5(0x10c)](_0x262675,_0x1ea4c3,_0x2557b1,_0x27146d);else{for(var _0x5428c8=_0x262675[_0x5372e5(0x127)]-0x1;_0x5428c8>=0x0;_0x5428c8--)if(_0x1c635f=_0x262675[_0x5428c8])_0x256d57=(_0x3c434e<0x3?_0x1c635f(_0x256d57):_0x3c434e>0x3?_0x1c635f(_0x1ea4c3,_0x2557b1,_0x256d57):_0x1c635f(_0x1ea4c3,_0x2557b1))||_0x256d57;}return _0x3c434e>0x3&&_0x256d57&&Object[_0x5372e5(0x11e)](_0x1ea4c3,_0x2557b1,_0x256d57),_0x256d57;},__metadata=this&&this[_0x51fcd6(0x13a)]||function(_0x2f8b48,_0x40666e){var _0x2fccc1=_0x51fcd6;if(typeof Reflect===_0x2fccc1(0x115)&&typeof Reflect[_0x2fccc1(0x110)]===_0x2fccc1(0x109))return Reflect[_0x2fccc1(0x110)](_0x2f8b48,_0x40666e);},QueueProcessor_1;Object[_0x51fcd6(0x11e)](exports,_0x51fcd6(0x102),{'value':!![]}),exports[_0x51fcd6(0x12e)]=void 0x0;const bull_1=require(_0x51fcd6(0x11f)),common_1=require('@nestjs/common'),midjourney_service_1=require(_0x51fcd6(0x139));function _0x1323(){var _0xdf1b26=['drawFailed','onQueueCompleted','165206kKKXvs','7jnUdjy','30aqDsOf','function','handleJob','1904796iiDLgU','decorate','message','6TrRGME','4810UJPFIa','metadata','队列恢复的时候调用','onQueueFailed','162302ENZETj','design:paramtypes','object','log','design:returntype','Process','\x20were\x20cleaned.','mjDraw','onQueuePaused',':\x20绘画失败\x20','onQueueDrained','defineProperty','@nestjs/bull','env','21411KjUbKA','\x20jobs\x20of\x20type\x20','onQueueError','prototype','10BMdLZp','队列任务的一个回调用于通知当前进度','length','28356IeYhdw','CONCURRENCY','MidjourneyService','Processor','OnQueueError','262124ZIXScg','QueueProcessor','队列发生错误','1235553OmAMrZ','error','MJDRAW','696seHIHf','OnQueueFailed','design:type','OnQueueCompleted','name','OnQueueResumed','../midjourney/midjourney.service','__metadata','Queue\x20failed:\x20','__decorate','logger','getOwnPropertyDescriptor','OnQueueCleaned','onQueueResumed','__esModule','Logger'];_0x1323=function(){return _0xdf1b26;};return _0x1323();}let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x393f77){var _0x15b563=_0x51fcd6;this['midjourneyService']=_0x393f77,this[_0x15b563(0xfe)]=new common_1[(_0x15b563(0x103))](QueueProcessor_1[_0x15b563(0x137)]);}async[_0x51fcd6(0x10a)](_0x1eafe3){const _0x350c28=await this['midjourneyService']['draw'](_0x1eafe3['data'],_0x1eafe3['id']);return _0x350c28;}['onQueueActive'](_0x1457c4){}[_0x51fcd6(0x123)](_0x39234){var _0x145e6=_0x51fcd6;console[_0x145e6(0x116)](_0x145e6(0x12f),_0x39234);}['onQueueProgress'](_0x618f9b,_0x38c7ef){var _0x487c51=_0x51fcd6;console[_0x487c51(0x116)](_0x487c51(0x126),_0x618f9b['id'],_0x38c7ef);}[_0x51fcd6(0x105)](_0x2725ca,_0xd1b2c){}[_0x51fcd6(0x112)](_0x2af62f,_0xabef38){var _0x48d4ff=_0x51fcd6;common_1[_0x48d4ff(0x103)][_0x48d4ff(0x131)](_0x48d4ff(0xfc)+_0xabef38[_0x48d4ff(0x10d)]+_0x48d4ff(0x11c)+_0x2af62f['id'],'QueueProcessor'),this['midjourneyService'][_0x48d4ff(0x104)](_0x2af62f['data']);}[_0x51fcd6(0x11b)](){console['log']('队列暂停的时候调用');}['onQueueResumed'](){var _0x2d881e=_0x51fcd6;console[_0x2d881e(0x116)](_0x2d881e(0x111));}['onQueueCleaned'](_0x1ac378,_0x36615e){var _0xa8502f=_0x51fcd6;common_1['Logger'][_0xa8502f(0x116)]('Queue\x20cleaned:\x20'+_0x1ac378['length']+_0xa8502f(0x122)+_0x36615e+_0xa8502f(0x119),_0xa8502f(0x12e));}[_0x51fcd6(0x11d)](){}};__decorate([(0x0,bull_1[_0x51fcd6(0x118)])({'name':_0x51fcd6(0x11a),'concurrency':process['env'][_0x51fcd6(0x129)]?+process[_0x51fcd6(0x120)][_0x51fcd6(0x129)]:0x3}),__metadata(_0x51fcd6(0x135),Function),__metadata(_0x51fcd6(0x114),[Object]),__metadata('design:returntype',Promise)],QueueProcessor[_0x51fcd6(0x124)],_0x51fcd6(0x10a),null),__decorate([(0x0,bull_1['OnQueueActive'])(),__metadata(_0x51fcd6(0x135),Function),__metadata(_0x51fcd6(0x114),[Object]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor[_0x51fcd6(0x124)],'onQueueActive',null),__decorate([(0x0,bull_1[_0x51fcd6(0x12c)])(),__metadata('design:type',Function),__metadata(_0x51fcd6(0x114),[Error]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor['prototype'],_0x51fcd6(0x123),null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x51fcd6(0x135),Function),__metadata('design:paramtypes',[Object,Number]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor[_0x51fcd6(0x124)],'onQueueProgress',null),__decorate([(0x0,bull_1[_0x51fcd6(0x136)])(),__metadata(_0x51fcd6(0x135),Function),__metadata('design:paramtypes',[Object,Object]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor[_0x51fcd6(0x124)],_0x51fcd6(0x105),null),__decorate([(0x0,bull_1[_0x51fcd6(0x134)])(),__metadata(_0x51fcd6(0x135),Function),__metadata(_0x51fcd6(0x114),[Object,Error]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x51fcd6(0x124)],_0x51fcd6(0x112),null),__decorate([(0x0,bull_1['OnQueuePaused'])(),__metadata(_0x51fcd6(0x135),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x51fcd6(0x11b),null),__decorate([(0x0,bull_1[_0x51fcd6(0x138)])(),__metadata(_0x51fcd6(0x135),Function),__metadata(_0x51fcd6(0x114),[]),__metadata('design:returntype',void 0x0)],QueueProcessor['prototype'],_0x51fcd6(0x101),null),__decorate([(0x0,bull_1[_0x51fcd6(0x100)])(),__metadata(_0x51fcd6(0x135),Function),__metadata(_0x51fcd6(0x114),[Array,String]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor[_0x51fcd6(0x124)],'onQueueCleaned',null),__decorate([(0x0,bull_1['OnQueueDrained'])(),__metadata('design:type',Function),__metadata(_0x51fcd6(0x114),[]),__metadata(_0x51fcd6(0x117),void 0x0)],QueueProcessor[_0x51fcd6(0x124)],_0x51fcd6(0x11d),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x51fcd6(0x12b)])(_0x51fcd6(0x132)),__metadata(_0x51fcd6(0x114),[midjourney_service_1[_0x51fcd6(0x12a)]])],QueueProcessor),exports[_0x51fcd6(0x12e)]=QueueProcessor;