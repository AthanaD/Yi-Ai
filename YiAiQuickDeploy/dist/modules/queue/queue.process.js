'use strict';var _0x28908d=_0x11db;(function(_0x1ff72a,_0x452c99){var _0x37ba15=_0x11db,_0x257229=_0x1ff72a();while(!![]){try{var _0x15cb1d=-parseInt(_0x37ba15(0x19f))/0x1*(parseInt(_0x37ba15(0x1a1))/0x2)+-parseInt(_0x37ba15(0x1b0))/0x3+-parseInt(_0x37ba15(0x1a7))/0x4+parseInt(_0x37ba15(0x1ae))/0x5+-parseInt(_0x37ba15(0x1d5))/0x6+-parseInt(_0x37ba15(0x19d))/0x7+parseInt(_0x37ba15(0x1b9))/0x8;if(_0x15cb1d===_0x452c99)break;else _0x257229['push'](_0x257229['shift']());}catch(_0x3d3861){_0x257229['push'](_0x257229['shift']());}}}(_0x11ba,0xf2fdf));function _0x11db(_0x3898d5,_0x5458a3){var _0x11ba42=_0x11ba();return _0x11db=function(_0x11db51,_0x193b79){_0x11db51=_0x11db51-0x19d;var _0x228452=_0x11ba42[_0x11db51];return _0x228452;},_0x11db(_0x3898d5,_0x5458a3);}function _0x11ba(){var _0x338a96=['Processor','OnQueueDrained','onQueueDrained','onQueueFailed','onQueueCompleted','logger','onQueueResumed','name','getOwnPropertyDescriptor','drawFailed','MidjourneyService','draw','metadata','mjDraw','6819258prYVpy','design:paramtypes','../midjourney/midjourney.service','onQueueActive','defineProperty','@nestjs/bull','Logger','data','5317158cEOLLd','length','5oJWvLY','队列暂停的时候调用','640678yLmeQS','onQueueError','队列发生错误','MJDRAW','prototype','OnQueueActive','715528PmyLhq','__esModule','Queue\x20failed:\x20','message','object','OnQueuePaused','OnQueueError','4981675MPbRJR','CONCURRENCY','5725290prnqNu','OnQueueFailed','design:returntype','design:type','error','\x20were\x20cleaned.','log','decorate','@nestjs/common','44672832JVRVgk','onQueueCleaned','队列任务的一个回调用于通知当前进度','handleJob','__decorate','OnQueueCleaned','\x20jobs\x20of\x20type\x20','midjourneyService','env','function','Process','QueueProcessor','onQueueProgress',':\x20绘画失败\x20'];_0x11ba=function(){return _0x338a96;};return _0x11ba();}var __decorate=this&&this[_0x28908d(0x1bd)]||function(_0x18ff01,_0x3ded58,_0x22423a,_0x42c105){var _0x11be9d=_0x28908d,_0x39f34b=arguments[_0x11be9d(0x19e)],_0x5d83fa=_0x39f34b<0x3?_0x3ded58:_0x42c105===null?_0x42c105=Object[_0x11be9d(0x1cf)](_0x3ded58,_0x22423a):_0x42c105,_0x3bb934;if(typeof Reflect===_0x11be9d(0x1ab)&&typeof Reflect[_0x11be9d(0x1b7)]===_0x11be9d(0x1c2))_0x5d83fa=Reflect['decorate'](_0x18ff01,_0x3ded58,_0x22423a,_0x42c105);else{for(var _0x21d78f=_0x18ff01['length']-0x1;_0x21d78f>=0x0;_0x21d78f--)if(_0x3bb934=_0x18ff01[_0x21d78f])_0x5d83fa=(_0x39f34b<0x3?_0x3bb934(_0x5d83fa):_0x39f34b>0x3?_0x3bb934(_0x3ded58,_0x22423a,_0x5d83fa):_0x3bb934(_0x3ded58,_0x22423a))||_0x5d83fa;}return _0x39f34b>0x3&&_0x5d83fa&&Object[_0x11be9d(0x1d9)](_0x3ded58,_0x22423a,_0x5d83fa),_0x5d83fa;},__metadata=this&&this['__metadata']||function(_0x46ed89,_0x221103){var _0x562ba3=_0x28908d;if(typeof Reflect===_0x562ba3(0x1ab)&&typeof Reflect[_0x562ba3(0x1d3)]==='function')return Reflect[_0x562ba3(0x1d3)](_0x46ed89,_0x221103);},QueueProcessor_1;Object[_0x28908d(0x1d9)](exports,_0x28908d(0x1a8),{'value':!![]}),exports[_0x28908d(0x1c4)]=void 0x0;const bull_1=require(_0x28908d(0x1da)),common_1=require(_0x28908d(0x1b8)),midjourney_service_1=require(_0x28908d(0x1d7));let QueueProcessor=QueueProcessor_1=class QueueProcessor{constructor(_0x43c7bf){var _0x35daeb=_0x28908d;this['midjourneyService']=_0x43c7bf,this[_0x35daeb(0x1cc)]=new common_1[(_0x35daeb(0x1db))](QueueProcessor_1[_0x35daeb(0x1ce)]);}async['handleJob'](_0xf1dc16){var _0x3b03d7=_0x28908d;const _0x34cea5=await this[_0x3b03d7(0x1c0)][_0x3b03d7(0x1d2)](_0xf1dc16[_0x3b03d7(0x1dc)],_0xf1dc16['id']);return _0x34cea5;}[_0x28908d(0x1d8)](_0x927ae4){}[_0x28908d(0x1a2)](_0x18c81f){var _0x16abbc=_0x28908d;console[_0x16abbc(0x1b6)](_0x16abbc(0x1a3),_0x18c81f);}[_0x28908d(0x1c5)](_0x49d737,_0x508643){var _0x56226b=_0x28908d;console[_0x56226b(0x1b6)](_0x56226b(0x1bb),_0x49d737['id'],_0x508643);}['onQueueCompleted'](_0xa6a0e9,_0x28e421){}[_0x28908d(0x1ca)](_0x20d3e7,_0x11e7f1){var _0x1e5010=_0x28908d;common_1[_0x1e5010(0x1db)][_0x1e5010(0x1b4)](_0x1e5010(0x1a9)+_0x11e7f1[_0x1e5010(0x1aa)]+_0x1e5010(0x1c6)+_0x20d3e7['id'],_0x1e5010(0x1c4)),this[_0x1e5010(0x1c0)][_0x1e5010(0x1d0)](_0x20d3e7[_0x1e5010(0x1dc)]);}['onQueuePaused'](){var _0x37d964=_0x28908d;console[_0x37d964(0x1b6)](_0x37d964(0x1a0));}[_0x28908d(0x1cd)](){var _0x2b6136=_0x28908d;console[_0x2b6136(0x1b6)]('队列恢复的时候调用');}[_0x28908d(0x1ba)](_0x29938a,_0xdb7002){var _0x5af29f=_0x28908d;common_1[_0x5af29f(0x1db)][_0x5af29f(0x1b6)]('Queue\x20cleaned:\x20'+_0x29938a[_0x5af29f(0x19e)]+_0x5af29f(0x1bf)+_0xdb7002+_0x5af29f(0x1b5),_0x5af29f(0x1c4));}[_0x28908d(0x1c9)](){}};__decorate([(0x0,bull_1[_0x28908d(0x1c3)])({'name':_0x28908d(0x1d4),'concurrency':process[_0x28908d(0x1c1)][_0x28908d(0x1af)]?+process[_0x28908d(0x1c1)]['CONCURRENCY']:0x3}),__metadata(_0x28908d(0x1b3),Function),__metadata('design:paramtypes',[Object]),__metadata(_0x28908d(0x1b2),Promise)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1bc),null),__decorate([(0x0,bull_1[_0x28908d(0x1a6)])(),__metadata('design:type',Function),__metadata('design:paramtypes',[Object]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1d8),null),__decorate([(0x0,bull_1[_0x28908d(0x1ad)])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[Error]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],'onQueueError',null),__decorate([(0x0,bull_1['OnQueueProgress'])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[Object,Number]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1c5),null),__decorate([(0x0,bull_1['OnQueueCompleted'])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[Object,Object]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1cb),null),__decorate([(0x0,bull_1[_0x28908d(0x1b1)])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[Object,Error]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1ca),null),__decorate([(0x0,bull_1[_0x28908d(0x1ac)])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x28908d(0x1a5)],'onQueuePaused',null),__decorate([(0x0,bull_1['OnQueueResumed'])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[]),__metadata('design:returntype',void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1cd),null),__decorate([(0x0,bull_1[_0x28908d(0x1be)])(),__metadata(_0x28908d(0x1b3),Function),__metadata(_0x28908d(0x1d6),[Array,String]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor['prototype'],_0x28908d(0x1ba),null),__decorate([(0x0,bull_1[_0x28908d(0x1c8)])(),__metadata('design:type',Function),__metadata(_0x28908d(0x1d6),[]),__metadata(_0x28908d(0x1b2),void 0x0)],QueueProcessor[_0x28908d(0x1a5)],_0x28908d(0x1c9),null),QueueProcessor=QueueProcessor_1=__decorate([(0x0,bull_1[_0x28908d(0x1c7)])(_0x28908d(0x1a4)),__metadata('design:paramtypes',[midjourney_service_1[_0x28908d(0x1d1)]])],QueueProcessor),exports[_0x28908d(0x1c4)]=QueueProcessor;