'use strict';const _0x2c1663=_0x4fa1;function _0x4fa1(_0x5505ec,_0x504c69){const _0x172a30=_0x172a();return _0x4fa1=function(_0x4fa136,_0x3f87d8){_0x4fa136=_0x4fa136-0x185;let _0x187003=_0x172a30[_0x4fa136];return _0x187003;},_0x4fa1(_0x5505ec,_0x504c69);}(function(_0x29aff9,_0x3b03c1){const _0x432d37=_0x4fa1,_0x2b2e39=_0x29aff9();while(!![]){try{const _0x4c3d47=-parseInt(_0x432d37(0x19d))/0x1+parseInt(_0x432d37(0x1ab))/0x2+-parseInt(_0x432d37(0x1a4))/0x3+parseInt(_0x432d37(0x1af))/0x4+parseInt(_0x432d37(0x18d))/0x5+parseInt(_0x432d37(0x190))/0x6*(parseInt(_0x432d37(0x1b4))/0x7)+parseInt(_0x432d37(0x1a1))/0x8*(-parseInt(_0x432d37(0x1a9))/0x9);if(_0x4c3d47===_0x3b03c1)break;else _0x2b2e39['push'](_0x2b2e39['shift']());}catch(_0x95e1ea){_0x2b2e39['push'](_0x2b2e39['shift']());}}}(_0x172a,0x6a06a));function _0x172a(){const _0x188947=['prototype','design:type','handleCron','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','27mlGnIJ','debug','1652594zNZlnH','@nestjs/common','defineProperty','EVERY_HOUR','2518348VvAjMk','update','InjectRepository','Repository','design:returntype','7phomLE','TaskService','metadata','userBalanceEntity','then','design:paramtypes','decorate','__param','__metadata','typeorm','437985HmVclP','globalConfigService','length','3848178REgWLA','Logger','Injectable','@nestjs/typeorm','ModelsService','UserBalanceEntity','./../globalConfig/globalConfig.service','__esModule','CronExpression','../models/models.service','object','会员已到期、清空所有余额并移除会员身份！','Cron','479018pyjZtv','EVERY_5_MINUTES','GlobalConfigService','LessThanOrEqual','1855544QiItyQ','../userBalance/userBalance.entity','modelsService','1727145QwEqCN'];_0x172a=function(){return _0x188947;};return _0x172a();}var __decorate=this&&this['__decorate']||function(_0x42cb2d,_0x5806b3,_0xdca21e,_0x32cac8){const _0x2926cb=_0x4fa1;var _0x51a9b5=arguments[_0x2926cb(0x18f)],_0x1c280a=_0x51a9b5<0x3?_0x5806b3:_0x32cac8===null?_0x32cac8=Object['getOwnPropertyDescriptor'](_0x5806b3,_0xdca21e):_0x32cac8,_0x53c5cf;if(typeof Reflect===_0x2926cb(0x19a)&&typeof Reflect[_0x2926cb(0x189)]==='function')_0x1c280a=Reflect[_0x2926cb(0x189)](_0x42cb2d,_0x5806b3,_0xdca21e,_0x32cac8);else{for(var _0x1892cd=_0x42cb2d[_0x2926cb(0x18f)]-0x1;_0x1892cd>=0x0;_0x1892cd--)if(_0x53c5cf=_0x42cb2d[_0x1892cd])_0x1c280a=(_0x51a9b5<0x3?_0x53c5cf(_0x1c280a):_0x51a9b5>0x3?_0x53c5cf(_0x5806b3,_0xdca21e,_0x1c280a):_0x53c5cf(_0x5806b3,_0xdca21e))||_0x1c280a;}return _0x51a9b5>0x3&&_0x1c280a&&Object[_0x2926cb(0x1ad)](_0x5806b3,_0xdca21e,_0x1c280a),_0x1c280a;},__metadata=this&&this[_0x2c1663(0x18b)]||function(_0x333d32,_0x214c1c){const _0x4a420a=_0x2c1663;if(typeof Reflect==='object'&&typeof Reflect[_0x4a420a(0x185)]==='function')return Reflect[_0x4a420a(0x185)](_0x333d32,_0x214c1c);},__param=this&&this[_0x2c1663(0x18a)]||function(_0x162ecc,_0x5d9257){return function(_0x2e9583,_0xd03d15){_0x5d9257(_0x2e9583,_0xd03d15,_0x162ecc);};};Object['defineProperty'](exports,_0x2c1663(0x197),{'value':!![]}),exports[_0x2c1663(0x1b5)]=void 0x0;const globalConfig_service_1=require(_0x2c1663(0x196)),common_1=require(_0x2c1663(0x1ac)),schedule_1=require('@nestjs/schedule'),userBalance_entity_1=require(_0x2c1663(0x1a2)),typeorm_1=require(_0x2c1663(0x193)),typeorm_2=require(_0x2c1663(0x18c)),models_service_1=require(_0x2c1663(0x199));let TaskService=class TaskService{constructor(_0xa8811f,_0x266298,_0x557435){const _0x18f803=_0x2c1663;this[_0x18f803(0x186)]=_0xa8811f,this[_0x18f803(0x18e)]=_0x266298,this[_0x18f803(0x1a3)]=_0x557435;}[_0x2c1663(0x1a7)](){const _0x1f3d75=_0x2c1663;common_1[_0x1f3d75(0x191)][_0x1f3d75(0x1aa)](_0x1f3d75(0x1a8),'TaskService'),this[_0x1f3d75(0x18e)]['getWechatAccessToken']();}async['checkUserMemerExpire'](){const _0xf36644=_0x2c1663,_0x2e8e59=await this[_0xf36644(0x186)]['find']({'where':{'expirationTime':(0x0,typeorm_2[_0xf36644(0x1a0)])(new Date())}});if(!_0x2e8e59||!_0x2e8e59['length'])return;_0x2e8e59['forEach'](_0x2941fe=>{const _0x463154=_0xf36644;this['userBalanceEntity'][_0x463154(0x1b0)]({'id':_0x2941fe['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x463154(0x187)](_0x5c49dd=>{const _0x27b76d=_0x463154;common_1[_0x27b76d(0x191)]['debug'](_0x2941fe['id']+_0x27b76d(0x19b),'TaskService');});});}};__decorate([(0x0,schedule_1[_0x2c1663(0x19c)])(schedule_1[_0x2c1663(0x198)][_0x2c1663(0x1ae)]),__metadata(_0x2c1663(0x1a6),Function),__metadata('design:paramtypes',[]),__metadata(_0x2c1663(0x1b3),void 0x0)],TaskService[_0x2c1663(0x1a5)],'handleCron',null),__decorate([(0x0,schedule_1[_0x2c1663(0x19c)])(schedule_1[_0x2c1663(0x198)][_0x2c1663(0x19e)]),__metadata(_0x2c1663(0x1a6),Function),__metadata(_0x2c1663(0x188),[]),__metadata(_0x2c1663(0x1b3),Promise)],TaskService[_0x2c1663(0x1a5)],'checkUserMemerExpire',null),TaskService=__decorate([(0x0,common_1[_0x2c1663(0x192)])(),__param(0x0,(0x0,typeorm_1[_0x2c1663(0x1b1)])(userBalance_entity_1[_0x2c1663(0x195)])),__metadata('design:paramtypes',[typeorm_2[_0x2c1663(0x1b2)],globalConfig_service_1[_0x2c1663(0x19f)],models_service_1[_0x2c1663(0x194)]])],TaskService),exports['TaskService']=TaskService;