'use strict';const _0xe0fb7e=_0x3210;(function(_0x311e62,_0x2ec6d4){const _0x30900f=_0x3210,_0x4a5536=_0x311e62();while(!![]){try{const _0x4ff778=parseInt(_0x30900f(0x13f))/0x1+-parseInt(_0x30900f(0x138))/0x2+-parseInt(_0x30900f(0x144))/0x3+-parseInt(_0x30900f(0x143))/0x4+parseInt(_0x30900f(0x135))/0x5+parseInt(_0x30900f(0x137))/0x6+parseInt(_0x30900f(0x147))/0x7*(parseInt(_0x30900f(0x118))/0x8);if(_0x4ff778===_0x2ec6d4)break;else _0x4a5536['push'](_0x4a5536['shift']());}catch(_0x18465c){_0x4a5536['push'](_0x4a5536['shift']());}}}(_0x1e4f,0x26c4b));function _0x3210(_0x34df04,_0x3adc7c){const _0x1e4f12=_0x1e4f();return _0x3210=function(_0x321017,_0xc1f42b){_0x321017=_0x321017-0x116;let _0x18db92=_0x1e4f12[_0x321017];return _0x18db92;},_0x3210(_0x34df04,_0x3adc7c);}var __decorate=this&&this['__decorate']||function(_0x1b2a72,_0x51034a,_0x174b06,_0x57f038){const _0x333251=_0x3210;var _0x403ebb=arguments['length'],_0x175790=_0x403ebb<0x3?_0x51034a:_0x57f038===null?_0x57f038=Object[_0x333251(0x13b)](_0x51034a,_0x174b06):_0x57f038,_0x16e21e;if(typeof Reflect===_0x333251(0x141)&&typeof Reflect[_0x333251(0x13a)]==='function')_0x175790=Reflect[_0x333251(0x13a)](_0x1b2a72,_0x51034a,_0x174b06,_0x57f038);else{for(var _0x54b349=_0x1b2a72[_0x333251(0x130)]-0x1;_0x54b349>=0x0;_0x54b349--)if(_0x16e21e=_0x1b2a72[_0x54b349])_0x175790=(_0x403ebb<0x3?_0x16e21e(_0x175790):_0x403ebb>0x3?_0x16e21e(_0x51034a,_0x174b06,_0x175790):_0x16e21e(_0x51034a,_0x174b06))||_0x175790;}return _0x403ebb>0x3&&_0x175790&&Object[_0x333251(0x13d)](_0x51034a,_0x174b06,_0x175790),_0x175790;},__metadata=this&&this[_0xe0fb7e(0x145)]||function(_0x29bbdf,_0xe998cf){const _0x130b91=_0xe0fb7e;if(typeof Reflect===_0x130b91(0x141)&&typeof Reflect[_0x130b91(0x119)]===_0x130b91(0x142))return Reflect[_0x130b91(0x119)](_0x29bbdf,_0xe998cf);},__param=this&&this[_0xe0fb7e(0x140)]||function(_0x42a480,_0x5a752e){return function(_0x3e166e,_0x262c31){_0x5a752e(_0x3e166e,_0x262c31,_0x42a480);};};Object[_0xe0fb7e(0x13d)](exports,_0xe0fb7e(0x131),{'value':!![]}),exports[_0xe0fb7e(0x11d)]=void 0x0;const globalConfig_service_1=require(_0xe0fb7e(0x125)),common_1=require(_0xe0fb7e(0x120)),schedule_1=require(_0xe0fb7e(0x13c)),userBalance_entity_1=require(_0xe0fb7e(0x12b)),typeorm_1=require('@nestjs/typeorm'),typeorm_2=require(_0xe0fb7e(0x11e)),models_service_1=require(_0xe0fb7e(0x12a));function _0x1e4f(){const _0x144873=['__metadata','Cron','7UYeIJE','LessThanOrEqual','checkUserMemerExpire','3660368IcKnXX','metadata','Injectable','debug','handleCron','TaskService','typeorm','update','@nestjs/common','getWechatAccessToken','userBalanceEntity','UserBalanceEntity','design:paramtypes','./../globalConfig/globalConfig.service','CronExpression','prototype','find','会员已到期、清空所有余额并移除会员身份！','../models/models.service','../userBalance/userBalance.entity','design:type','InjectRepository','GlobalConfigService','design:returntype','length','__esModule','Repository','EVERY_5_MINUTES','EVERY_HOUR','601360OFCdpv','forEach','639654BQVbFL','340090TvQHXy','Logger','decorate','getOwnPropertyDescriptor','@nestjs/schedule','defineProperty','globalConfigService','160590xYvzWh','__param','object','function','1113068UdDJqf','713730LCRwri'];_0x1e4f=function(){return _0x144873;};return _0x1e4f();}let TaskService=class TaskService{constructor(_0xc2bcbe,_0x51878b,_0x243ba1){const _0x16b88d=_0xe0fb7e;this[_0x16b88d(0x122)]=_0xc2bcbe,this[_0x16b88d(0x13e)]=_0x51878b,this['modelsService']=_0x243ba1;}[_0xe0fb7e(0x11c)](){const _0x292aa1=_0xe0fb7e;common_1[_0x292aa1(0x139)][_0x292aa1(0x11b)]('Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token',_0x292aa1(0x11d)),this['globalConfigService'][_0x292aa1(0x121)]();}async[_0xe0fb7e(0x117)](){const _0x2b0798=_0xe0fb7e,_0x43aa63=await this['userBalanceEntity'][_0x2b0798(0x128)]({'where':{'expirationTime':(0x0,typeorm_2[_0x2b0798(0x116)])(new Date())}});if(!_0x43aa63||!_0x43aa63[_0x2b0798(0x130)])return;_0x43aa63[_0x2b0798(0x136)](_0xf31ca7=>{const _0x50a10f=_0x2b0798;this['userBalanceEntity'][_0x50a10f(0x11f)]({'id':_0xf31ca7['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})['then'](_0x1693e4=>{const _0x2b5ab1=_0x50a10f;common_1[_0x2b5ab1(0x139)][_0x2b5ab1(0x11b)](_0xf31ca7['id']+_0x2b5ab1(0x129),_0x2b5ab1(0x11d));});});}};__decorate([(0x0,schedule_1[_0xe0fb7e(0x146)])(schedule_1[_0xe0fb7e(0x126)][_0xe0fb7e(0x134)]),__metadata(_0xe0fb7e(0x12c),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],TaskService[_0xe0fb7e(0x127)],_0xe0fb7e(0x11c),null),__decorate([(0x0,schedule_1['Cron'])(schedule_1[_0xe0fb7e(0x126)][_0xe0fb7e(0x133)]),__metadata(_0xe0fb7e(0x12c),Function),__metadata(_0xe0fb7e(0x124),[]),__metadata(_0xe0fb7e(0x12f),Promise)],TaskService['prototype'],_0xe0fb7e(0x117),null),TaskService=__decorate([(0x0,common_1[_0xe0fb7e(0x11a)])(),__param(0x0,(0x0,typeorm_1[_0xe0fb7e(0x12d)])(userBalance_entity_1[_0xe0fb7e(0x123)])),__metadata('design:paramtypes',[typeorm_2[_0xe0fb7e(0x132)],globalConfig_service_1[_0xe0fb7e(0x12e)],models_service_1['ModelsService']])],TaskService),exports['TaskService']=TaskService;