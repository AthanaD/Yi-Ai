'use strict';function _0x1214(_0x1c1710,_0x1f6128){const _0x4d8186=_0x4d81();return _0x1214=function(_0x12140a,_0x590bbf){_0x12140a=_0x12140a-0x195;let _0x53977c=_0x4d8186[_0x12140a];return _0x53977c;},_0x1214(_0x1c1710,_0x1f6128);}const _0xd6ae63=_0x1214;(function(_0xc3d40,_0x2cd7f2){const _0x4b00c8=_0x1214,_0x3f52a4=_0xc3d40();while(!![]){try{const _0x296e26=parseInt(_0x4b00c8(0x1ac))/0x1*(parseInt(_0x4b00c8(0x198))/0x2)+-parseInt(_0x4b00c8(0x1ad))/0x3+parseInt(_0x4b00c8(0x1c2))/0x4+-parseInt(_0x4b00c8(0x1a9))/0x5+-parseInt(_0x4b00c8(0x1c1))/0x6*(parseInt(_0x4b00c8(0x1b1))/0x7)+parseInt(_0x4b00c8(0x1a7))/0x8+-parseInt(_0x4b00c8(0x19a))/0x9*(-parseInt(_0x4b00c8(0x1a8))/0xa);if(_0x296e26===_0x2cd7f2)break;else _0x3f52a4['push'](_0x3f52a4['shift']());}catch(_0x34ba21){_0x3f52a4['push'](_0x3f52a4['shift']());}}}(_0x4d81,0xb6caa));var __decorate=this&&this['__decorate']||function(_0xeab290,_0xcce02,_0x4ff8d2,_0x5e93f1){const _0x165c34=_0x1214;var _0x17970a=arguments[_0x165c34(0x1bc)],_0x4162e7=_0x17970a<0x3?_0xcce02:_0x5e93f1===null?_0x5e93f1=Object[_0x165c34(0x1c7)](_0xcce02,_0x4ff8d2):_0x5e93f1,_0x23968a;if(typeof Reflect===_0x165c34(0x1b0)&&typeof Reflect[_0x165c34(0x1b3)]===_0x165c34(0x1bd))_0x4162e7=Reflect[_0x165c34(0x1b3)](_0xeab290,_0xcce02,_0x4ff8d2,_0x5e93f1);else{for(var _0x462c10=_0xeab290[_0x165c34(0x1bc)]-0x1;_0x462c10>=0x0;_0x462c10--)if(_0x23968a=_0xeab290[_0x462c10])_0x4162e7=(_0x17970a<0x3?_0x23968a(_0x4162e7):_0x17970a>0x3?_0x23968a(_0xcce02,_0x4ff8d2,_0x4162e7):_0x23968a(_0xcce02,_0x4ff8d2))||_0x4162e7;}return _0x17970a>0x3&&_0x4162e7&&Object[_0x165c34(0x1a0)](_0xcce02,_0x4ff8d2,_0x4162e7),_0x4162e7;},__metadata=this&&this[_0xd6ae63(0x1a3)]||function(_0x4bf57f,_0x1534d3){const _0x29e251=_0xd6ae63;if(typeof Reflect===_0x29e251(0x1b0)&&typeof Reflect[_0x29e251(0x1a5)]===_0x29e251(0x1bd))return Reflect['metadata'](_0x4bf57f,_0x1534d3);},__param=this&&this[_0xd6ae63(0x196)]||function(_0x56e2e0,_0x21a905){return function(_0x217e22,_0x391b0e){_0x21a905(_0x217e22,_0x391b0e,_0x56e2e0);};};Object[_0xd6ae63(0x1a0)](exports,_0xd6ae63(0x1a2),{'value':!![]}),exports['TaskService']=void 0x0;const globalConfig_service_1=require('./../globalConfig/globalConfig.service'),common_1=require(_0xd6ae63(0x19d)),schedule_1=require(_0xd6ae63(0x1ab)),userBalance_entity_1=require(_0xd6ae63(0x1c5)),typeorm_1=require(_0xd6ae63(0x199)),typeorm_2=require('typeorm'),models_service_1=require(_0xd6ae63(0x1a4));function _0x4d81(){const _0x41f441=['50944knrkqE','@nestjs/typeorm','639UgsNHh','LessThanOrEqual','find','@nestjs/common','InjectRepository','Automatically\x20refresh\x20WeChat\x20access\x20every\x20hour\x20Token','defineProperty','globalConfigService','__esModule','__metadata','../models/models.service','metadata','design:paramtypes','3714968kaUWRI','199960GsvbCn','7143610eXfiNF','Cron','@nestjs/schedule','56AzjuBX','1712922tnzYcD','update','EVERY_HOUR','object','798623WjEUkA','then','decorate','UserBalanceEntity','debug','modelsService','会员已到期、清空所有余额并移除会员身份！','Logger','checkUserMemerExpire','TaskService','CronExpression','length','function','userBalanceEntity','EVERY_5_MINUTES','Injectable','42ASFIVQ','946056bfboNj','getWechatAccessToken','forEach','../userBalance/userBalance.entity','prototype','getOwnPropertyDescriptor','design:type','__param','handleCron'];_0x4d81=function(){return _0x41f441;};return _0x4d81();}let TaskService=class TaskService{constructor(_0x11c278,_0x4e76cb,_0x424f2d){const _0x2fb8db=_0xd6ae63;this['userBalanceEntity']=_0x11c278,this[_0x2fb8db(0x1a1)]=_0x4e76cb,this[_0x2fb8db(0x1b6)]=_0x424f2d;}['handleCron'](){const _0x1cd38a=_0xd6ae63;common_1['Logger'][_0x1cd38a(0x1b5)](_0x1cd38a(0x19f),_0x1cd38a(0x1ba)),this[_0x1cd38a(0x1a1)][_0x1cd38a(0x1c3)]();}async[_0xd6ae63(0x1b9)](){const _0x15fcab=_0xd6ae63,_0x343cfc=await this[_0x15fcab(0x1be)][_0x15fcab(0x19c)]({'where':{'expirationTime':(0x0,typeorm_2[_0x15fcab(0x19b)])(new Date())}});if(!_0x343cfc||!_0x343cfc['length'])return;_0x343cfc[_0x15fcab(0x1c4)](_0x1df75f=>{const _0x1d9998=_0x15fcab;this[_0x1d9998(0x1be)][_0x1d9998(0x1ae)]({'id':_0x1df75f['id']},{'expirationTime':null,'packageId':0x0,'memberModel3Count':0x0,'memberModel4Count':0x0,'memberDrawMjCount':0x0})[_0x1d9998(0x1b2)](_0x378ff5=>{const _0x11832a=_0x1d9998;common_1[_0x11832a(0x1b8)]['debug'](_0x1df75f['id']+_0x11832a(0x1b7),_0x11832a(0x1ba));});});}};__decorate([(0x0,schedule_1[_0xd6ae63(0x1aa)])(schedule_1['CronExpression'][_0xd6ae63(0x1af)]),__metadata(_0xd6ae63(0x195),Function),__metadata('design:paramtypes',[]),__metadata('design:returntype',void 0x0)],TaskService[_0xd6ae63(0x1c6)],_0xd6ae63(0x197),null),__decorate([(0x0,schedule_1[_0xd6ae63(0x1aa)])(schedule_1[_0xd6ae63(0x1bb)][_0xd6ae63(0x1bf)]),__metadata(_0xd6ae63(0x195),Function),__metadata(_0xd6ae63(0x1a6),[]),__metadata('design:returntype',Promise)],TaskService['prototype'],'checkUserMemerExpire',null),TaskService=__decorate([(0x0,common_1[_0xd6ae63(0x1c0)])(),__param(0x0,(0x0,typeorm_1[_0xd6ae63(0x19e)])(userBalance_entity_1[_0xd6ae63(0x1b4)])),__metadata(_0xd6ae63(0x1a6),[typeorm_2['Repository'],globalConfig_service_1['GlobalConfigService'],models_service_1['ModelsService']])],TaskService),exports[_0xd6ae63(0x1ba)]=TaskService;